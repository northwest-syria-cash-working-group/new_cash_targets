ggplot(aes(x = wounded_dead, y = wounded_dead_100k)) +
geom_point(aes(size = eq_score)) +
geom_text_repel(aes(label = sub_district),
point.padding = .5,
segment.color = "grey50", size = 3) +
scale_size_continuous(range = c(0.5, 8)) +
scale_x_log10(labels = comma, breaks = c(0, 10, 30, 100, 300, 1000, 3000)) +
scale_y_log10(labels = comma, breaks = c(0, 10, 30, 100, 300, 1000, 3000)) +
labs(x = "Number of wounded and dead",
y = "Wounded and dead per 100k persons") +
eq %>%
left_join(locations %>% distinct(admin3pcode, sub_district = admin3name_en),
by = "admin3pcode") %>%
left_join(eq_score$data %>% select(admin3pcode, eq_score),
by = "admin3pcode") %>%
ggplot(aes(x = damaged_houses, y = damaged_houses_100k)) +
geom_point(aes(size = eq_score)) +
geom_text_repel(aes(label = sub_district),
point.padding = .5,
segment.color = "grey50", size = 3) +
scale_size_continuous(range = c(0.5, 8)) +
scale_x_log10(labels = comma, breaks = c(0, 10, 30, 100, 300, 1000, 3000)) +
scale_y_log10(labels = comma, breaks = c(0, 10, 30, 100, 300, 1000, 3000)) +
labs(x = "Number of damaged houses",
y = "Damaged houses per 100k persons") +
plot_layout(guides = "collect") &
theme(legend.position = "bottom") +
plot_annotation(title = "Magnitude and severity of earthquake impacts",
subtitle = "At sub-district level")
eq %>%
left_join(locations %>% distinct(admin3pcode, sub_district = admin3name_en),
by = "admin3pcode") %>%
left_join(eq_score$data %>% select(admin3pcode, eq_score),
by = "admin3pcode") %>%
ggplot(aes(x = wounded_dead, y = wounded_dead_100k)) +
geom_point(aes(size = eq_score)) +
geom_text_repel(aes(label = sub_district),
point.padding = .5,
segment.color = "grey50", size = 3) +
scale_size_continuous(range = c(0.5, 8)) +
scale_x_log10(labels = comma, breaks = c(0, 10, 30, 100, 300, 1000, 3000)) +
scale_y_log10(labels = comma, breaks = c(0, 10, 30, 100, 300, 1000, 3000)) +
labs(x = "Number of wounded and dead",
y = "Wounded and dead per 100k persons") +
eq %>%
left_join(locations %>% distinct(admin3pcode, sub_district = admin3name_en),
by = "admin3pcode") %>%
left_join(eq_score$data %>% select(admin3pcode, eq_score),
by = "admin3pcode") %>%
ggplot(aes(x = damaged_houses, y = damaged_houses_100k)) +
geom_point(aes(size = eq_score)) +
geom_text_repel(aes(label = sub_district),
point.padding = .5,
segment.color = "grey50", size = 3) +
scale_size_continuous(range = c(0.5, 8)) +
scale_x_log10(labels = comma, breaks = c(0, 10, 30, 100, 300, 1000, 3000)) +
scale_y_log10(labels = comma, breaks = c(0, 10, 30, 100, 300, 1000, 3000)) +
labs(x = "Number of damaged houses",
y = "Damaged houses per 100k persons") +
plot_annotation(title = "Magnitude and severity of earthquake impacts",
subtitle = "At sub-district level") +
plot_layout(guides = "collect") &
theme(legend.position = "bottom")
eq %>%
left_join(locations %>% distinct(admin3pcode, sub_district = admin3name_en),
by = "admin3pcode") %>%
left_join(eq_score$data %>% select(admin3pcode, eq_score),
by = "admin3pcode") %>%
ggplot(aes(x = wounded_dead, y = damaged_houses)) +
geom_point(aes(size = eq_score)) +
geom_text_repel(aes(label = sub_district),
point.padding = .5,
segment.color = "grey50", size = 3) +
scale_size_continuous(range = c(0.5, 8)) +
scale_x_log10(labels = comma, breaks = c(0, 10, 30, 100, 300, 1000, 3000)) +
scale_y_log10(labels = comma, breaks = c(0, 10, 30, 100, 300, 1000, 3000)) +
labs(x = "Number of wounded and dead",
y = "Wounded and dead per 100k persons") +
eq %>%
left_join(locations %>% distinct(admin3pcode, sub_district = admin3name_en),
by = "admin3pcode") %>%
left_join(eq_score$data %>% select(admin3pcode, eq_score),
by = "admin3pcode") %>%
ggplot(aes(x = wounded_dead_100k, y = damaged_houses_100k)) +
geom_point(aes(size = eq_score)) +
geom_text_repel(aes(label = sub_district),
point.padding = .5,
segment.color = "grey50", size = 3) +
scale_size_continuous(range = c(0.5, 8)) +
scale_x_log10(labels = comma, breaks = c(0, 10, 30, 100, 300, 1000, 3000)) +
scale_y_log10(labels = comma, breaks = c(0, 10, 30, 100, 300, 1000, 3000)) +
labs(x = "Number of damaged houses",
y = "Damaged houses per 100k persons") +
plot_annotation(title = "Magnitude and severity of earthquake impacts",
subtitle = "At sub-district level") +
plot_layout(guides = "collect") &
theme(legend.position = "bottom")
eq %>%
left_join(locations %>% distinct(admin3pcode, sub_district = admin3name_en),
by = "admin3pcode") %>%
left_join(eq_score$data %>% select(admin3pcode, eq_score),
by = "admin3pcode") %>%
ggplot(aes(x = wounded_dead, y = wounded_dead_100k)) +
geom_point(aes(size = eq_score)) +
geom_text_repel(aes(label = sub_district),
point.padding = .5,
segment.color = "grey50", size = 3) +
scale_size_continuous(range = c(0.5, 8)) +
scale_x_log10(labels = comma, breaks = c(0, 10, 30, 100, 300, 1000, 3000)) +
scale_y_log10(labels = comma, breaks = c(0, 10, 30, 100, 300, 1000, 3000)) +
labs(x = "Number of wounded and dead",
y = "Wounded and dead per 100k persons") +
eq %>%
left_join(locations %>% distinct(admin3pcode, sub_district = admin3name_en),
by = "admin3pcode") %>%
left_join(eq_score$data %>% select(admin3pcode, eq_score),
by = "admin3pcode") %>%
ggplot(aes(x = damaged_houses, y = damaged_houses_100k)) +
geom_point(aes(size = eq_score)) +
geom_text_repel(aes(label = sub_district),
point.padding = .5,
segment.color = "grey50", size = 3) +
scale_size_continuous(range = c(0.5, 8)) +
scale_x_log10(labels = comma, breaks = c(0, 10, 30, 100, 300, 1000, 3000)) +
scale_y_log10(labels = comma, breaks = c(0, 10, 30, 100, 300, 1000, 3000)) +
labs(x = "Number of damaged houses",
y = "Damaged houses per 100k persons") +
plot_annotation(title = "Magnitude and severity of earthquake impacts",
subtitle = "At sub-district level") +
plot_layout(guides = "collect") &
theme(legend.position = "bottom")
eq %>%
left_join(locations %>% distinct(admin3pcode, sub_district = admin3name_en),
by = "admin3pcode") %>%
left_join(eq_score$data %>% select(admin3pcode, eq_score),
by = "admin3pcode") %>%
ggplot(aes(x = wounded_dead, y = wounded_dead_100k)) +
geom_point(aes(size = eq_score)) +
geom_text_repel(aes(label = sub_district),
point.padding = .5,
segment.color = "grey50", size = 3) +
scale_size_continuous(range = c(0.5, 8)) +
scale_x_log10(labels = comma, breaks = c(0, 10, 30, 100, 300, 1000, 3000)) +
scale_y_log10(labels = comma, breaks = c(0, 10, 30, 100, 300, 1000, 3000)) +
labs(x = "Number of wounded and dead",
y = "Wounded and dead per 100k persons") +
eq %>%
left_join(locations %>% distinct(admin3pcode, sub_district = admin3name_en),
by = "admin3pcode") %>%
left_join(eq_score$data %>% select(admin3pcode, eq_score),
by = "admin3pcode") %>%
ggplot(aes(x = damaged_houses, y = damaged_houses_100k)) +
geom_point(aes(size = eq_score)) +
geom_text_repel(aes(label = sub_district),
point.padding = .5,
segment.color = "grey50", size = 3) +
scale_size_continuous(range = c(0.5, 8)) +
scale_x_log10(labels = comma, breaks = c(0, 10, 30, 100, 300, 1000, 3000)) +
scale_y_log10(labels = comma, breaks = c(0, 10, 30, 100, 300, 1000, 3000)) +
labs(x = "Number of damaged houses",
y = "Damaged houses per 100k persons") +
annotate("rect", xmin = 300, xmax = 4000, ymin = 300, ymax = 4000,
alpha = .1, fill = "blue") +
plot_annotation(title = "Magnitude and severity of earthquake impacts",
subtitle = "At sub-district level") +
plot_layout(guides = "collect") &
theme(legend.position = "bottom")
eq %>%
left_join(locations %>% distinct(admin3pcode, sub_district = admin3name_en),
by = "admin3pcode") %>%
left_join(eq_score$data %>% select(admin3pcode, eq_score),
by = "admin3pcode") %>%
ggplot(aes(x = wounded_dead, y = wounded_dead_100k)) +
geom_point(aes(size = eq_score)) +
geom_text_repel(aes(label = sub_district),
point.padding = .5,
segment.color = "grey50", size = 3) +
scale_size_continuous(range = c(0.5, 8)) +
scale_x_log10(labels = comma, breaks = c(0, 10, 30, 100, 300, 1000, 3000)) +
scale_y_log10(labels = comma, breaks = c(0, 10, 30, 100, 300, 1000, 3000)) +
labs(x = "Number of wounded and dead",
y = "Wounded and dead per 100k persons") +
eq %>%
left_join(locations %>% distinct(admin3pcode, sub_district = admin3name_en),
by = "admin3pcode") %>%
left_join(eq_score$data %>% select(admin3pcode, eq_score),
by = "admin3pcode") %>%
ggplot(aes(x = damaged_houses, y = damaged_houses_100k)) +
geom_point(aes(size = eq_score)) +
geom_text_repel(aes(label = sub_district),
point.padding = .5,
segment.color = "grey50", size = 3) +
scale_size_continuous(range = c(0.5, 8)) +
scale_x_log10(labels = comma, breaks = c(0, 10, 30, 100, 300, 1000, 3000)) +
scale_y_log10(labels = comma, breaks = c(0, 10, 30, 100, 300, 1000, 3000)) +
labs(x = "Number of damaged houses",
y = "Damaged houses per 100k persons") +
annotate("rect", xmin = 300,  ymin = 300,
alpha = .1, fill = "blue") +
plot_annotation(title = "Magnitude and severity of earthquake impacts",
subtitle = "At sub-district level") +
plot_layout(guides = "collect") &
theme(legend.position = "bottom")
eq %>%
left_join(locations %>% distinct(admin3pcode, sub_district = admin3name_en),
by = "admin3pcode") %>%
left_join(eq_score$data %>% select(admin3pcode, eq_score),
by = "admin3pcode") %>%
ggplot(aes(x = wounded_dead, y = wounded_dead_100k)) +
geom_point(aes(size = eq_score)) +
geom_text_repel(aes(label = sub_district),
point.padding = .5,
segment.color = "grey50", size = 3) +
scale_size_continuous(range = c(0.5, 8)) +
scale_x_log10(labels = comma, breaks = c(0, 10, 30, 100, 300, 1000, 3000)) +
scale_y_log10(labels = comma, breaks = c(0, 10, 30, 100, 300, 1000, 3000)) +
labs(x = "Number of wounded and dead",
y = "Wounded and dead per 100k persons") +
eq %>%
left_join(locations %>% distinct(admin3pcode, sub_district = admin3name_en),
by = "admin3pcode") %>%
left_join(eq_score$data %>% select(admin3pcode, eq_score),
by = "admin3pcode") %>%
ggplot(aes(x = damaged_houses, y = damaged_houses_100k)) +
geom_point(aes(size = eq_score)) +
geom_text_repel(aes(label = sub_district),
point.padding = .5,
segment.color = "grey50", size = 3) +
scale_size_continuous(range = c(0.5, 8)) +
scale_x_log10(labels = comma, breaks = c(0, 10, 30, 100, 300, 1000, 3000)) +
scale_y_log10(labels = comma, breaks = c(0, 10, 30, 100, 300, 1000, 3000)) +
labs(x = "Number of damaged houses",
y = "Damaged houses per 100k persons") +
annotate("rect", xmin = 300,  xmax = Inf, ymin = 300, ymax = Inf,
alpha = .1, fill = "blue") +
plot_annotation(title = "Magnitude and severity of earthquake impacts",
subtitle = "At sub-district level") +
plot_layout(guides = "collect") &
theme(legend.position = "bottom")
eq %>%
left_join(locations %>% distinct(admin3pcode, sub_district = admin3name_en),
by = "admin3pcode") %>%
left_join(eq_score$data %>% select(admin3pcode, eq_score),
by = "admin3pcode") %>%
ggplot(aes(x = wounded_dead, y = wounded_dead_100k)) +
geom_point(aes(size = eq_score)) +
geom_text_repel(aes(label = sub_district),
point.padding = .5,
segment.color = "grey50", size = 3) +
scale_size_continuous(range = c(0.5, 8)) +
scale_x_log10(labels = comma, breaks = c(0, 10, 30, 100, 300, 1000, 3000)) +
scale_y_log10(labels = comma, breaks = c(0, 10, 30, 100, 300, 1000, 3000)) +
labs(x = "Number of wounded and dead",
y = "Wounded and dead per 100k persons") +
eq %>%
left_join(locations %>% distinct(admin3pcode, sub_district = admin3name_en),
by = "admin3pcode") %>%
left_join(eq_score$data %>% select(admin3pcode, eq_score),
by = "admin3pcode") %>%
ggplot(aes(x = damaged_houses, y = damaged_houses_100k)) +
geom_point(aes(size = eq_score)) +
geom_text_repel(aes(label = sub_district),
point.padding = .5,
segment.color = "grey50", size = 3) +
scale_size_continuous(range = c(0.5, 8)) +
scale_x_log10(labels = comma, breaks = c(0, 10, 30, 100, 300, 1000, 3000)) +
scale_y_log10(labels = comma, breaks = c(0, 10, 30, 100, 300, 1000, 3000)) +
labs(x = "Number of damaged houses",
y = "Damaged houses per 100k persons") +
annotate("rect", xmin = 100,  xmax = Inf, ymin = 100, ymax = Inf,
alpha = .1, fill = "blue") +
plot_annotation(title = "Magnitude and severity of earthquake impacts",
subtitle = "At sub-district level") +
plot_layout(guides = "collect") &
theme(legend.position = "bottom")
eq %>% glimpse()
eq %>%
left_join(locations %>% distinct(admin3pcode, sub_district = admin3name_en),
by = "admin3pcode") %>%
left_join(eq_score$data %>% select(admin3pcode, eq_score),
by = "admin3pcode") %>%
ggplot(aes(x = wounded_dead, y = wounded_dead_100k)) +
geom_point(aes(size = eq_score)) +
geom_text_repel(aes(label = sub_district),
point.padding = .5,
segment.color = "grey50", size = 3) +
scale_size_continuous(range = c(0.5, 8)) +
scale_x_log10(labels = comma, breaks = c(0, 10, 30, 100, 300, 1000, 3000)) +
scale_y_log10(labels = comma, breaks = c(0, 10, 30, 100, 300, 1000, 3000)) +
labs(x = "Number of wounded and dead",
y = "Wounded and dead per 100k persons") +
eq %>%
left_join(locations %>% distinct(admin3pcode, sub_district = admin3name_en),
by = "admin3pcode") %>%
left_join(eq_score$data %>% select(admin3pcode, eq_score),
by = "admin3pcode") %>%
ggplot(aes(x = damaged_houses, y = damaged_houses_100k)) +
geom_point(aes(size = eq_score)) +
geom_text_repel(aes(label = sub_district),
point.padding = .5,
segment.color = "grey50", size = 3) +
scale_size_continuous(range = c(0.5, 8)) +
scale_x_log10(labels = comma, breaks = c(0, 10, 30, 100, 300, 1000, 3000)) +
scale_y_log10(labels = comma, breaks = c(0, 10, 30, 100, 300, 1000, 3000)) +
labs(x = "Number of damaged houses",
y = "Damaged houses per 100k persons") +
annotate("rect", xmin = 100,  xmax = Inf, ymin = 100, ymax = Inf,
alpha = .1, fill = "blue") +
plot_annotation(title = "Magnitude and severity of earthquake impacts",
subtitle = "At sub-district level") +
plot_layout(guides = "collect") &
theme(legend.position = "bottom")
eq %>% count(admin3pcode)
eq %>% count(admin3pcode)
eq %>%
summarise(wounded_dead = mean(wounded_dead, na.rm = TRUE),
damaged_houses = mean(damaged_houses, na.rm = TRUE))
eq %>%
summarise(wounded_dead = median(wounded_dead, na.rm = TRUE),
damaged_houses = median(damaged_houses, na.rm = TRUE))
eq %>%
summarise(wounded_dead = median(wounded_dead, na.rm = TRUE),
wounded_dead_100k = median(wounded_dead_100k, na.rm = TRUE),
damaged_houses = median(damaged_houses, na.rm = TRUE),
damaged_houses_100k = median(damaged_houses_100k, na.rm = TRUE))
eq %>%
left_join(locations %>% distinct(admin3pcode, sub_district = admin3name_en),
by = "admin3pcode") %>%
left_join(eq_score$data %>% select(admin3pcode, eq_score),
by = "admin3pcode") %>%
ggplot(aes(x = wounded_dead, y = wounded_dead_100k)) +
geom_point(aes(size = eq_score)) +
geom_text_repel(aes(label = sub_district),
point.padding = .5,
segment.color = "grey50", size = 3) +
scale_size_continuous(range = c(0.5, 8)) +
scale_x_log10(labels = comma, breaks = c(0, 10, 30, 100, 300, 1000, 3000)) +
scale_y_log10(labels = comma, breaks = c(0, 10, 30, 100, 300, 1000, 3000)) +
labs(x = "Number of wounded and dead",
y = "Wounded and dead per 100k persons") +
annotate("rect", xmin = 109.5,  xmax = Inf, ymin = 101.7189	, ymax = Inf,
alpha = .1, fill = "blue") +
eq %>%
left_join(locations %>% distinct(admin3pcode, sub_district = admin3name_en),
by = "admin3pcode") %>%
left_join(eq_score$data %>% select(admin3pcode, eq_score),
by = "admin3pcode") %>%
ggplot(aes(x = damaged_houses, y = damaged_houses_100k)) +
geom_point(aes(size = eq_score)) +
geom_text_repel(aes(label = sub_district),
point.padding = .5,
segment.color = "grey50", size = 3) +
scale_size_continuous(range = c(0.5, 8)) +
scale_x_log10(labels = comma, breaks = c(0, 10, 30, 100, 300, 1000, 3000)) +
scale_y_log10(labels = comma, breaks = c(0, 10, 30, 100, 300, 1000, 3000)) +
labs(x = "Number of damaged houses",
y = "Damaged houses per 100k persons") +
annotate("rect", xmin = 125,  xmax = Inf, ymin = 187.0812	, ymax = Inf,
alpha = .1, fill = "blue") +
plot_annotation(title = "Magnitude and severity of earthquake impacts",
subtitle = "At sub-district level") +
plot_layout(guides = "collect") &
theme(legend.position = "bottom")
eq %>%
left_join(locations %>% distinct(admin3pcode, sub_district = admin3name_en),
by = "admin3pcode") %>%
left_join(eq_score$data %>% select(admin3pcode, eq_score),
by = "admin3pcode") %>%
ggplot(aes(x = wounded_dead, y = eq_score)) +
geom_point() +
geom_smooth(se = FALSE, colour = "blue", size = .5)
eq %>%
left_join(locations %>% distinct(admin3pcode, sub_district = admin3name_en),
by = "admin3pcode") %>%
left_join(eq_score$data %>% select(admin3pcode, eq_score),
by = "admin3pcode") %>%
ggplot(aes(x = wounded_dead, y = eq_score)) +
geom_point() +
geom_smooth(colour = "blue", size = .5, method = "lm")
eq %>%
left_join(locations %>% distinct(admin3pcode, sub_district = admin3name_en),
by = "admin3pcode") %>%
left_join(eq_score$data %>% select(admin3pcode, eq_score),
by = "admin3pcode") %>%
ggplot(aes(x = wounded_dead, y = eq_score)) +
geom_point() +
geom_smooth(colour = "blue", size = .5, method = "lm") +
scale_x_log10()
eq %>%
left_join(locations %>% distinct(admin3pcode, sub_district = admin3name_en),
by = "admin3pcode") %>%
left_join(eq_score$data %>% select(admin3pcode, eq_score),
by = "admin3pcode") %>%
ggplot(aes(x = wounded_dead, y = eq_score)) +
geom_point() +
geom_smooth(colour = "blue", size = .5, method = "lm") +
scale_x_log10() +
eq %>%
left_join(locations %>% distinct(admin3pcode, sub_district = admin3name_en),
by = "admin3pcode") %>%
left_join(eq_score$data %>% select(admin3pcode, eq_score),
by = "admin3pcode") %>%
ggplot(aes(x = wounded_dead_100k, y = eq_score)) +
geom_point() +
geom_smooth(colour = "blue", size = .5, method = "lm") +
scale_x_log10() +
eq %>%
left_join(locations %>% distinct(admin3pcode, sub_district = admin3name_en),
by = "admin3pcode") %>%
left_join(eq_score$data %>% select(admin3pcode, eq_score),
by = "admin3pcode") %>%
ggplot(aes(x = damaged_houses, y = eq_score)) +
geom_point() +
geom_smooth(colour = "blue", size = .5, method = "lm") +
scale_x_log10() +
eq %>%
left_join(locations %>% distinct(admin3pcode, sub_district = admin3name_en),
by = "admin3pcode") %>%
left_join(eq_score$data %>% select(admin3pcode, eq_score),
by = "admin3pcode") %>%
ggplot(aes(x = damaged_houses_100k, y = eq_score)) +
geom_point() +
geom_smooth(colour = "blue", size = .5, method = "lm") +
scale_x_log10() +
plot_layout(ncol = 2)
eq %>%
left_join(locations %>% distinct(admin3pcode, sub_district = admin3name_en),
by = "admin3pcode") %>%
left_join(eq_score$data %>% select(admin3pcode, eq_score),
by = "admin3pcode") %>%
ggplot(aes(x = wounded_dead, y = eq_score)) +
geom_point() +
geom_smooth(colour = "blue", size = .5, method = "lm") +
expand_limits(y = 0) +
scale_x_log10() +
eq %>%
left_join(locations %>% distinct(admin3pcode, sub_district = admin3name_en),
by = "admin3pcode") %>%
left_join(eq_score$data %>% select(admin3pcode, eq_score),
by = "admin3pcode") %>%
ggplot(aes(x = wounded_dead_100k, y = eq_score)) +
geom_point() +
geom_smooth(colour = "blue", size = .5, method = "lm") +
expand_limits(y = 0) +
scale_x_log10() +
eq %>%
left_join(locations %>% distinct(admin3pcode, sub_district = admin3name_en),
by = "admin3pcode") %>%
left_join(eq_score$data %>% select(admin3pcode, eq_score),
by = "admin3pcode") %>%
ggplot(aes(x = damaged_houses, y = eq_score)) +
geom_point() +
geom_smooth(colour = "blue", size = .5, method = "lm") +
expand_limits(y = 0) +
scale_x_log10() +
eq %>%
left_join(locations %>% distinct(admin3pcode, sub_district = admin3name_en),
by = "admin3pcode") %>%
left_join(eq_score$data %>% select(admin3pcode, eq_score),
by = "admin3pcode") %>%
ggplot(aes(x = damaged_houses_100k, y = eq_score)) +
geom_point() +
geom_smooth(colour = "blue", size = .5, method = "lm") +
expand_limits(y = 0) +
scale_x_log10() +
plot_layout(ncol = 2)
eq %>%
left_join(locations %>% distinct(admin3pcode, sub_district = admin3name_en),
by = "admin3pcode") %>%
left_join(eq_score$data %>% select(admin3pcode, eq_score),
by = "admin3pcode") %>%
lm(eq_score ~ wounded_dead + wounded_dead_100k + damaged_houses + damaged_houses_100k,
data = .) %>%
summary()
eq %>%
left_join(locations %>% distinct(admin3pcode, sub_district = admin3name_en),
by = "admin3pcode") %>%
left_join(eq_score$data %>% select(admin3pcode, eq_score),
by = "admin3pcode") %>%
ggplot(aes(x = wounded_dead, y = wounded_dead_100k)) +
geom_jitter(aes(size = eq_score)) +
geom_text_repel(aes(label = sub_district),
point.padding = .5,
segment.color = "grey50", size = 2) +
scale_size_continuous(range = c(0.5, 8)) +
scale_x_log10(labels = comma, breaks = c(0, 10, 30, 100, 300, 1000, 3000)) +
scale_y_log10(labels = comma, breaks = c(0, 10, 30, 100, 300, 1000, 3000)) +
labs(x = "Number of wounded and dead",
y = "Wounded and dead per 100k persons") +
annotate("rect", xmin = 109.5,  xmax = Inf, ymin = 101.7189	, ymax = Inf,
alpha = .1, fill = "blue") +
eq %>%
left_join(locations %>% distinct(admin3pcode, sub_district = admin3name_en),
by = "admin3pcode") %>%
left_join(eq_score$data %>% select(admin3pcode, eq_score),
by = "admin3pcode") %>%
ggplot(aes(x = damaged_houses, y = damaged_houses_100k)) +
geom_jitter(aes(size = eq_score)) +
geom_text_repel(aes(label = sub_district),
point.padding = .5,
segment.color = "grey50", size = 2) +
scale_size_continuous(range = c(0.5, 8)) +
scale_x_log10(labels = comma, breaks = c(0, 10, 30, 100, 300, 1000, 3000)) +
scale_y_log10(labels = comma, breaks = c(0, 10, 30, 100, 300, 1000, 3000)) +
labs(x = "Number of damaged houses",
y = "Damaged houses per 100k persons") +
annotate("rect", xmin = 125,  xmax = Inf, ymin = 187.0812	, ymax = Inf,
alpha = .1, fill = "blue") +
plot_annotation(title = "Magnitude and severity of earthquake impacts",
subtitle = "At sub-district level; above-median values within blue box") +
plot_layout(guides = "collect") &
theme(legend.position = "bottom")
